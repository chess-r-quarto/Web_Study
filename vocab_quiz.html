<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz.app</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel (for JSX) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts (Inter) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; }
        /* Smooth transition for theme switching */
        .theme-transition { transition: background-color 0.5s ease, color 0.5s ease, border-color 0.5s ease; }
        
        /* Custom Scrollbar for the list */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(156, 163, 175, 0.3); border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(156, 163, 175, 0.5); }
    </style>
</head>
<body class="overflow-hidden">

<div id="root"></div>

<script type="text/babel">
    const { useState, useEffect, useRef, useMemo } = React;

    // --- ICONS (SVG Components) ---
    const Icon = ({ children, className }) => (
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
    );
    const XIcon = ({size=24}) => <Icon className={`w-${size/4} h-${size/4}`}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></Icon>;
    const MinusIcon = ({size=24}) => <Icon className={`w-${size/4} h-${size/4}`}><path d="M5 12h14"/></Icon>;
    const PlusIcon = ({size=24}) => <Icon className={`w-${size/4} h-${size/4}`}><path d="M5 12h14"/><path d="M12 5v14"/></Icon>;
    const UploadIcon = () => <Icon><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></Icon>;
    const MoonIcon = () => <Icon><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/></Icon>;
    const SunIcon = () => <Icon><circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/><path d="m4.93 4.93 1.41 1.41"/><path d="m17.66 17.66 1.41 1.41"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66-1.41 1.41"/><path d="m19.07 4.93-1.41 1.41"/></Icon>;
    const ArrowRightIcon = () => <Icon><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></Icon>;
    const RotateCcwIcon = () => <Icon><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74-2.74L3 12"/><path d="M3 3v9h9"/></Icon>;
    const CheckCircle2Icon = ({className}) => <Icon className={className}><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></Icon>;
    const XCircleIcon = ({className}) => <Icon className={className}><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></Icon>;
    const BarChart3Icon = ({size=24}) => <Icon className={`w-${size/4} h-${size/4}`}><path d="M3 3v18h18"/><path d="M18 17V9"/><path d="M13 17V5"/><path d="M8 17v-3"/></Icon>;

    // --- DATA ---
    const DEFAULT_DATA = [
      {
        "id": "demo_001",
        "term": "Static Type Checking",
        "category": "IT",
        "subcategory": "TypeScript",
        "meaning": "Detecting errors in code without running it based on value types.",
        "distractor": "Checking for errors and exceptions while the program is actively running."
      },
      {
        "id": "demo_002",
        "term": "Superset",
        "category": "IT",
        "subcategory": "TypeScript",
        "meaning": "A language that includes all features of another language plus additional rules.",
        "distractor": "A simplified version of a language that removes complex features."
      },
      {
        "id": "demo_003",
        "term": "Type Inference",
        "category": "IT",
        "subcategory": "TypeScript",
        "meaning": "The ability of the compiler to automatically deduce the type of a value.",
        "distractor": "Manually specifying the type for every variable to prevent errors."
      }
    ];

    // --- COMPONENTS ---

    const WindowButton = ({ type, onClick }) => {
        const colors = {
            close: "bg-[#FF5F57] border-[#E0443E] text-[#420C09]",
            minimize: "bg-[#FEBC2E] border-[#D89E24] text-[#5C3B0D]",
            maximize: "bg-[#28C840] border-[#1AAB29] text-[#0B4011]"
        };
        const icons = {
            close: <XIcon size={8} />,
            minimize: <MinusIcon size={8} />,
            maximize: <PlusIcon size={8} />
        };
        return (
            <button onClick={onClick} className={`w-3 h-3 rounded-full border flex items-center justify-center group ${colors[type]} transition-all shadow-sm focus:outline-none`}>
                <span className="opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                    {icons[type]}
                </span>
            </button>
        );
    };

    const Button = ({ onClick, children, variant = "primary", className = "", disabled = false, isDark = false }) => {
        const baseStyles = "px-6 py-3 rounded-lg font-medium transition-all duration-200 flex items-center justify-center gap-2 active:scale-[0.98] text-sm";
        
        let variantStyles = "";
        if (variant === "primary") {
            variantStyles = isDark 
                ? "bg-blue-600 text-white hover:bg-blue-500 shadow-md shadow-blue-900/20 disabled:opacity-40 disabled:cursor-not-allowed"
                : "bg-blue-600 text-white hover:bg-blue-500 shadow-md shadow-blue-500/20 disabled:opacity-50 disabled:cursor-not-allowed";
        } else if (variant === "secondary") {
            variantStyles = isDark
                ? "bg-slate-800 text-slate-200 hover:bg-slate-700 border border-slate-700 disabled:opacity-50"
                : "bg-white text-slate-700 hover:bg-slate-50 border border-slate-200 disabled:opacity-50";
        } else if (variant === "ghost") {
            variantStyles = isDark
                ? "text-slate-400 hover:text-slate-200 hover:bg-white/5"
                : "text-slate-500 hover:text-slate-800 hover:bg-black/5";
        }

        return (
            <button onClick={onClick} disabled={disabled} className={`${baseStyles} ${variantStyles} ${className}`}>
                {children}
            </button>
        );
    };

    // --- MAIN APP ---

    function App() {
        const [isDark, setIsDark] = useState(true);
        const [data, setData] = useState(DEFAULT_DATA);
        const [appState, setAppState] = useState('start'); // 'start' | 'quiz' | 'result'
        const [currentIndex, setCurrentIndex] = useState(0);
        const [score, setScore] = useState(0);
        const [isAnswered, setIsAnswered] = useState(false);
        const [selectedOption, setSelectedOption] = useState(null);
        const [currentOptions, setCurrentOptions] = useState([]);
        const fileInputRef = useRef(null);

        // -- LOGIC --
        useEffect(() => {
            if (currentIndex < data.length) {
                const item = data[currentIndex];
                const opts = [
                    { text: item.meaning, isCorrect: true },
                    { text: item.distractor, isCorrect: false }
                ];
                // Random shuffle
                setCurrentOptions(Math.random() < 0.5 ? opts : opts.reverse());
            }
        }, [currentIndex, data, appState]);

        const toggleFullscreen = () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(e => console.log(e));
            } else {
                if (document.exitFullscreen) document.exitFullscreen().catch(e => console.log(e));
            }
        };

        const handleExitFullscreenOnly = () => {
             if (document.fullscreenElement && document.exitFullscreen) document.exitFullscreen();
        };

        const handleFileUpload = (event) => {
            const file = event.target.files?.[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const json = JSON.parse(e.target?.result);
                    if (Array.isArray(json) && json.length > 0 && json[0].term) {
                        const shuffled = [...json].sort(() => Math.random() - 0.5);
                        setData(shuffled);
                        setAppState('quiz');
                        setCurrentIndex(0);
                        setScore(0);
                    } else {
                        alert("Invalid JSON format.");
                    }
                } catch (err) {
                    alert("Failed to parse JSON.");
                }
            };
            reader.readAsText(file);
        };

        const startDefaultQuiz = () => {
            const shuffled = [...DEFAULT_DATA].sort(() => Math.random() - 0.5);
            setData(shuffled);
            setAppState('quiz');
            setCurrentIndex(0);
            setScore(0);
        };

        const handleAnswer = (idx) => {
            if (isAnswered) return;
            setSelectedOption(idx);
            setIsAnswered(true);
            if (currentOptions[idx].isCorrect) setScore(s => s + 1);
        };

        const handleNext = () => {
            if (currentIndex + 1 < data.length) {
                setCurrentIndex(c => c + 1);
                setIsAnswered(false);
                setSelectedOption(null);
            } else {
                setAppState('result');
            }
        };

        const handleReset = () => {
            setAppState('start');
            setCurrentIndex(0);
            setScore(0);
            setIsAnswered(false);
            setSelectedOption(null);
        };

        // -- THEME STYLES (Computed) --
        const theme = useMemo(() => ({
            bg: isDark ? "bg-[#1E1E24]" : "bg-[#E0E5EC]", // Simplified bg for standalone
            window: isDark 
                ? "bg-[#282930]/90 border-white/5 shadow-black/40 text-slate-200" 
                : "bg-[#F6F6F6]/90 border-white/40 shadow-2xl text-slate-800",
            header: isDark 
                ? "from-white/5 to-transparent border-white/5" 
                : "from-white/50 to-transparent border-black/5",
            headerText: isDark ? "text-slate-400" : "text-slate-500/80",
            uploadBox: isDark
                ? "bg-[#32333E] border-[#444550] text-slate-300 hover:bg-[#3B3C48] hover:border-blue-500/50"
                : "bg-white border-slate-200 text-slate-700 hover:bg-blue-50 hover:border-blue-400",
            divider: isDark ? "bg-slate-700" : "bg-slate-200",
            subText: isDark ? "text-slate-500" : "text-slate-400",
            progressBarBg: isDark ? "bg-slate-700" : "bg-slate-200",
            progressBarFill: isDark ? "bg-blue-500" : "bg-slate-900",
            cardTitle: isDark ? "text-slate-100" : "text-slate-900",
            cardSubtitle: isDark ? "text-slate-500" : "text-slate-500",
            optionBtn: {
                base: isDark ? "bg-[#32333E] border-[#444550] text-slate-300" : "bg-white border-white/50 text-slate-800",
                hover: isDark ? "hover:bg-[#3B3C48]" : "hover:shadow-md hover:-translate-y-0.5",
                correct: isDark ? "bg-green-900/20 border-green-800 ring-green-500/30 text-green-400" : "bg-green-50 border-green-200 ring-green-500/20 text-green-900",
                wrong: isDark ? "bg-red-900/20 border-red-800 ring-red-500/30 text-red-400 opacity-60" : "bg-red-50 border-red-200 ring-red-500/20 text-red-900 opacity-60",
                dimmed: "opacity-50"
            },
            footer: isDark ? "bg-[#1A1B20]/40 border-white/5" : "bg-white/40 border-black/5",
            resultCard: isDark ? "bg-[#32333E] border-[#444550]" : "bg-white border-slate-100",
            resultIconBox: isDark ? "bg-blue-500/10 text-blue-400" : "bg-blue-50 text-blue-600",
        }), [isDark]);

        return (
            <div className={`theme-transition min-h-screen flex items-center justify-center p-4 font-sans ${theme.bg}`}>
                
                {/* WINDOW FRAME */}
                <div className={`
                    w-full max-w-4xl backdrop-blur-2xl rounded-xl border overflow-hidden flex flex-col transition-all duration-500 theme-transition
                    ${appState === 'quiz' ? 'h-[80vh] min-h-[600px]' : 'h-[65vh] min-h-[500px]'}
                    ${theme.window}
                `}>
                    
                    {/* HEADER */}
                    <div className={`h-10 bg-gradient-to-b border-b flex items-center justify-between px-4 select-none cursor-default ${theme.header}`}>
                        <div className="flex items-center gap-2 w-20">
                            <WindowButton type="close" onClick={handleReset} />
                            <WindowButton type="minimize" onClick={handleExitFullscreenOnly} />
                            <WindowButton type="maximize" onClick={toggleFullscreen} />
                        </div>
                        
                        <div className={`text-xs font-medium tracking-wide ${theme.headerText}`}>
                            Quiz.app
                        </div>

                        <div className="flex items-center justify-end w-20 gap-2">
                            <button 
                                onClick={() => setIsDark(!isDark)}
                                className={`p-1.5 rounded-md transition-colors ${isDark ? 'hover:bg-white/10 text-slate-400' : 'hover:bg-black/5 text-slate-500'}`}
                                title="Toggle Theme"
                            >
                                {isDark ? <SunIcon /> : <MoonIcon />}
                            </button>
                        </div>
                    </div>

                    {/* CONTENT */}
                    <div className="flex-1 relative overflow-y-auto">
                        
                        {/* START */}
                        {appState === 'start' && (
                            <div className="absolute inset-0 flex flex-col items-center justify-center p-8 space-y-8 animate-in fade-in zoom-in duration-300">
                                <div className="text-center space-y-2">
                                    <div className={`w-20 h-20 rounded-2xl shadow-lg flex items-center justify-center mx-auto mb-6 text-3xl transition-colors duration-300 ${isDark ? 'bg-[#3B3C48] text-slate-200' : 'bg-white text-slate-900'}`}>
                                        ðŸŽ“
                                    </div>
                                    <h1 className={`text-3xl font-bold tracking-tight ${theme.cardTitle}`}>Vocabulary Master</h1>
                                    <p className={theme.subText}>Import your JSON deck or start with the demo.</p>
                                </div>

                                <div className="grid gap-4 w-full max-w-sm">
                                    <div 
                                        className={`border-2 border-dashed rounded-xl p-8 flex flex-col items-center justify-center gap-3 cursor-pointer transition-all duration-200 group ${theme.uploadBox}`}
                                        onClick={() => fileInputRef.current?.click()}
                                    >
                                        <div className={`p-3 rounded-full transition-colors ${isDark ? 'bg-blue-500/10 text-blue-400' : 'bg-blue-50 text-blue-600'}`}>
                                            <UploadIcon />
                                        </div>
                                        <div className="text-center">
                                            <span className="font-semibold">Import JSON Deck</span>
                                            <p className={`text-xs mt-1 ${theme.subText}`}>Click to browse files</p>
                                        </div>
                                        <input type="file" accept=".json" ref={fileInputRef} className="hidden" onChange={handleFileUpload} />
                                    </div>

                                    <div className={`flex items-center justify-center gap-2 text-xs font-medium uppercase tracking-widest my-2 ${theme.subText}`}>
                                        <span className={`h-px w-full ${theme.divider}`}></span>
                                        <span>OR</span>
                                        <span className={`h-px w-full ${theme.divider}`}></span>
                                    </div>

                                    <Button onClick={startDefaultQuiz} variant="primary" className="w-full" isDark={isDark}>
                                        Start Demo Quiz
                                    </Button>
                                </div>
                            </div>
                        )}

                        {/* QUIZ */}
                        {appState === 'quiz' && (
                            <div className="h-full flex flex-col animate-in slide-in-from-right duration-300">
                                <div className={`px-8 py-6 flex items-center justify-between border-b ${isDark ? 'border-white/5' : 'border-black/5'}`}>
                                    <div className="flex flex-col">
                                        <span className="text-xs font-bold text-blue-500 uppercase tracking-wider mb-1">
                                            {data[currentIndex].category}
                                        </span>
                                        <span className={`text-sm font-medium ${isDark ? 'text-slate-400' : 'text-slate-600'}`}>
                                            {data[currentIndex].subcategory || "General"}
                                        </span>
                                    </div>
                                    <div className="flex items-center gap-3">
                                        <div className="text-right">
                                            <div className={`text-sm font-bold ${theme.cardTitle}`}>
                                                {currentIndex + 1} <span className={theme.subText}>/ {data.length}</span>
                                            </div>
                                        </div>
                                        <div className={`w-24 h-1.5 rounded-full overflow-hidden ${theme.progressBarBg}`}>
                                            <div className={`h-full transition-all duration-500 ease-out ${theme.progressBarFill}`} style={{ width: `${((currentIndex + (isAnswered ? 1 : 0)) / data.length) * 100}%` }} />
                                        </div>
                                    </div>
                                </div>

                                <div className="flex-1 flex flex-col items-center justify-center p-8 md:p-12 overflow-y-auto">
                                    <div className="w-full max-w-3xl space-y-10">
                                        <div className="text-center space-y-4">
                                            <h2 className={`text-3xl md:text-5xl font-bold leading-tight ${theme.cardTitle}`}>
                                                {data[currentIndex].term}
                                            </h2>
                                            <p className={`font-medium text-lg ${theme.cardSubtitle}`}>Select the correct definition</p>
                                        </div>

                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            {currentOptions.map((opt, idx) => {
                                                let itemClass = `relative p-6 rounded-2xl text-left border transition-all duration-200 flex flex-col gap-3 min-h-[140px] `;
                                                if (isAnswered) {
                                                    if (opt.isCorrect) itemClass += theme.optionBtn.correct;
                                                    else if (selectedOption === idx) itemClass += theme.optionBtn.wrong;
                                                    else itemClass += `${theme.optionBtn.base} ${theme.optionBtn.dimmed}`;
                                                } else {
                                                    itemClass += `${theme.optionBtn.base} ${theme.optionBtn.hover}`;
                                                }
                                                return (
                                                    <button key={idx} disabled={isAnswered} onClick={() => handleAnswer(idx)} className={itemClass}>
                                                        <div className="flex justify-between items-start w-full">
                                                            <span className="text-[10px] font-bold uppercase tracking-widest opacity-40">Option {String.fromCharCode(65 + idx)}</span>
                                                            {isAnswered && opt.isCorrect && <CheckCircle2Icon className="w-5 h-5 text-green-500" />}
                                                            {isAnswered && !opt.isCorrect && selectedOption === idx && <XCircleIcon className="w-5 h-5 text-red-500" />}
                                                        </div>
                                                        <span className="text-base font-medium leading-relaxed">{opt.text}</span>
                                                    </button>
                                                );
                                            })}
                                        </div>
                                    </div>
                                </div>

                                <div className={`h-20 border-t flex items-center justify-between px-8 backdrop-blur-sm ${theme.footer}`}>
                                    <div className="flex items-center gap-2 text-sm font-medium">
                                        {isAnswered ? (
                                            currentOptions[selectedOption]?.isCorrect 
                                            ? <span className="text-green-500 flex items-center gap-2">Correct Answer</span> 
                                            : <span className="text-red-500 flex items-center gap-2">Incorrect</span>
                                        ) : (
                                            <span className={theme.subText}>Choose an option...</span>
                                        )}
                                    </div>
                                    <Button onClick={handleNext} disabled={!isAnswered} variant="primary" isDark={isDark} className={`${!isAnswered ? 'opacity-0 translate-y-2 pointer-events-none' : 'opacity-100 translate-y-0'}`}>
                                        {currentIndex + 1 === data.length ? "Finish Quiz" : "Next Question"} <ArrowRightIcon />
                                    </Button>
                                </div>
                            </div>
                        )}

                        {/* RESULT */}
                        {appState === 'result' && (
                            <div className="absolute inset-0 flex flex-col items-center justify-center p-8 animate-in fade-in zoom-in duration-300">
                                <div className={`rounded-3xl p-10 shadow-xl border max-w-md w-full text-center space-y-8 ${theme.resultCard}`}>
                                    <div className="space-y-2">
                                        <div className={`inline-flex items-center justify-center p-4 rounded-full mb-4 ${theme.resultIconBox}`}>
                                            <BarChart3Icon size={32} />
                                        </div>
                                        <h2 className={`text-2xl font-bold ${theme.cardTitle}`}>Session Complete</h2>
                                        <p className={theme.subText}>Here is how you performed</p>
                                    </div>
                                    <div className={`py-6 border-t border-b grid grid-cols-2 gap-4 ${isDark ? 'border-slate-700' : 'border-slate-100'}`}>
                                        <div className="space-y-1">
                                            <div className={`text-3xl font-bold ${theme.cardTitle}`}>{score}</div>
                                            <div className={`text-xs font-bold uppercase tracking-wider ${theme.subText}`}>Correct</div>
                                        </div>
                                        <div className="space-y-1">
                                            <div className={`text-3xl font-bold ${theme.cardTitle}`}>{Math.round((score / data.length) * 100)}%</div>
                                            <div className={`text-xs font-bold uppercase tracking-wider ${theme.subText}`}>Accuracy</div>
                                        </div>
                                    </div>
                                    <div className="flex flex-col gap-3">
                                        <Button onClick={handleReset} variant="primary" className="w-full" isDark={isDark}>
                                            <RotateCcwIcon /> Restart / New Deck
                                        </Button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            </div>
        );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
</script>
</body>
</html>
